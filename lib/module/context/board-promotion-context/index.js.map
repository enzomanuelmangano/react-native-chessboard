{"version":3,"names":["React","useCallback","useMemo","useState","PromotionDialog","BoardPromotionContext","createContext","showPromotionDialog","isPromoting","BoardPromotionContextProvider","memo","children","dialog","setDialog","isDialogActive","type","onSelect","piece","value"],"sources":["index.tsx"],"sourcesContent":["import React, { useCallback, useMemo, useState } from 'react';\r\nimport type { ChessInstance, PieceType } from 'chess.js';\r\nimport { PromotionDialog } from './dialog';\r\n\r\nexport type BoardPromotionContextType = {\r\n  showPromotionDialog: (_: {\r\n    type: PromotionDialogType;\r\n    onSelect?: (_: PieceType) => void;\r\n  }) => void;\r\n  isPromoting: boolean;\r\n};\r\n\r\nconst BoardPromotionContext = React.createContext<BoardPromotionContextType>({\r\n  showPromotionDialog: () => {\r\n    //\r\n  },\r\n  isPromoting: false,\r\n});\r\n\r\ntype PromotionDialogType = ReturnType<ChessInstance['turn']>;\r\n\r\nexport type BoardPromotionContextState = {\r\n  isDialogActive: boolean;\r\n  type?: PromotionDialogType;\r\n  onSelect?: (_: PieceType) => void;\r\n};\r\n\r\nconst BoardPromotionContextProvider: React.FC = React.memo(({ children }) => {\r\n  const [dialog, setDialog] = useState<BoardPromotionContextState>({\r\n    isDialogActive: false,\r\n  });\r\n\r\n  const showPromotionDialog: BoardPromotionContextType['showPromotionDialog'] =\r\n    useCallback(({ type, onSelect }) => {\r\n      setDialog({ isDialogActive: true, type, onSelect });\r\n    }, []);\r\n\r\n  const onSelect = useCallback(\r\n    (piece: PieceType) => {\r\n      dialog.onSelect?.(piece);\r\n      setDialog({ isDialogActive: false });\r\n    },\r\n    [dialog]\r\n  );\r\n\r\n  const value = useMemo(\r\n    () => ({\r\n      showPromotionDialog,\r\n      isPromoting: dialog.isDialogActive,\r\n    }),\r\n    [dialog.isDialogActive, showPromotionDialog]\r\n  );\r\n\r\n  return (\r\n    <BoardPromotionContext.Provider value={value}>\r\n      {dialog.isDialogActive && (\r\n        <PromotionDialog type=\"w\" {...dialog} onSelect={onSelect} />\r\n      )}\r\n      {children}\r\n    </BoardPromotionContext.Provider>\r\n  );\r\n});\r\n\r\nexport { BoardPromotionContextProvider, BoardPromotionContext };\r\n"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,WAAhB,EAA6BC,OAA7B,EAAsCC,QAAtC,QAAsD,OAAtD;AAEA,SAASC,eAAT,QAAgC,UAAhC;AAUA,MAAMC,qBAAqB,gBAAGL,KAAK,CAACM,aAAN,CAA+C;EAC3EC,mBAAmB,EAAE,MAAM,CACzB;EACD,CAH0E;EAI3EC,WAAW,EAAE;AAJ8D,CAA/C,CAA9B;AAeA,MAAMC,6BAAuC,gBAAGT,KAAK,CAACU,IAAN,CAAW,QAAkB;EAAA,IAAjB;IAAEC;EAAF,CAAiB;EAC3E,MAAM,CAACC,MAAD,EAASC,SAAT,IAAsBV,QAAQ,CAA6B;IAC/DW,cAAc,EAAE;EAD+C,CAA7B,CAApC;EAIA,MAAMP,mBAAqE,GACzEN,WAAW,CAAC,SAAwB;IAAA,IAAvB;MAAEc,IAAF;MAAQC;IAAR,CAAuB;IAClCH,SAAS,CAAC;MAAEC,cAAc,EAAE,IAAlB;MAAwBC,IAAxB;MAA8BC;IAA9B,CAAD,CAAT;EACD,CAFU,EAER,EAFQ,CADb;EAKA,MAAMA,QAAQ,GAAGf,WAAW,CACzBgB,KAAD,IAAsB;IAAA;;IACpB,oBAAAL,MAAM,CAACI,QAAP,2EAAAJ,MAAM,EAAYK,KAAZ,CAAN;IACAJ,SAAS,CAAC;MAAEC,cAAc,EAAE;IAAlB,CAAD,CAAT;EACD,CAJyB,EAK1B,CAACF,MAAD,CAL0B,CAA5B;EAQA,MAAMM,KAAK,GAAGhB,OAAO,CACnB,OAAO;IACLK,mBADK;IAELC,WAAW,EAAEI,MAAM,CAACE;EAFf,CAAP,CADmB,EAKnB,CAACF,MAAM,CAACE,cAAR,EAAwBP,mBAAxB,CALmB,CAArB;EAQA,oBACE,oBAAC,qBAAD,CAAuB,QAAvB;IAAgC,KAAK,EAAEW;EAAvC,GACGN,MAAM,CAACE,cAAP,iBACC,oBAAC,eAAD;IAAiB,IAAI,EAAC;EAAtB,GAA8BF,MAA9B;IAAsC,QAAQ,EAAEI;EAAhD,GAFJ,EAIGL,QAJH,CADF;AAQD,CAlC+C,CAAhD;AAoCA,SAASF,6BAAT,EAAwCJ,qBAAxC"}