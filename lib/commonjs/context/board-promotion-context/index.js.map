{"version":3,"names":["BoardPromotionContext","React","createContext","showPromotionDialog","isPromoting","BoardPromotionContextProvider","memo","children","dialog","setDialog","useState","isDialogActive","useCallback","type","onSelect","piece","value","useMemo"],"sources":["index.tsx"],"sourcesContent":["import React, { useCallback, useMemo, useState } from 'react';\r\nimport type { ChessInstance, PieceType } from 'chess.js';\r\nimport { PromotionDialog } from './dialog';\r\n\r\nexport type BoardPromotionContextType = {\r\n  showPromotionDialog: (_: {\r\n    type: PromotionDialogType;\r\n    onSelect?: (_: PieceType) => void;\r\n  }) => void;\r\n  isPromoting: boolean;\r\n};\r\n\r\nconst BoardPromotionContext = React.createContext<BoardPromotionContextType>({\r\n  showPromotionDialog: () => {\r\n    //\r\n  },\r\n  isPromoting: false,\r\n});\r\n\r\ntype PromotionDialogType = ReturnType<ChessInstance['turn']>;\r\n\r\nexport type BoardPromotionContextState = {\r\n  isDialogActive: boolean;\r\n  type?: PromotionDialogType;\r\n  onSelect?: (_: PieceType) => void;\r\n};\r\n\r\nconst BoardPromotionContextProvider: React.FC = React.memo(({ children }) => {\r\n  const [dialog, setDialog] = useState<BoardPromotionContextState>({\r\n    isDialogActive: false,\r\n  });\r\n\r\n  const showPromotionDialog: BoardPromotionContextType['showPromotionDialog'] =\r\n    useCallback(({ type, onSelect }) => {\r\n      setDialog({ isDialogActive: true, type, onSelect });\r\n    }, []);\r\n\r\n  const onSelect = useCallback(\r\n    (piece: PieceType) => {\r\n      dialog.onSelect?.(piece);\r\n      setDialog({ isDialogActive: false });\r\n    },\r\n    [dialog]\r\n  );\r\n\r\n  const value = useMemo(\r\n    () => ({\r\n      showPromotionDialog,\r\n      isPromoting: dialog.isDialogActive,\r\n    }),\r\n    [dialog.isDialogActive, showPromotionDialog]\r\n  );\r\n\r\n  return (\r\n    <BoardPromotionContext.Provider value={value}>\r\n      {dialog.isDialogActive && (\r\n        <PromotionDialog type=\"w\" {...dialog} onSelect={onSelect} />\r\n      )}\r\n      {children}\r\n    </BoardPromotionContext.Provider>\r\n  );\r\n});\r\n\r\nexport { BoardPromotionContextProvider, BoardPromotionContext };\r\n"],"mappings":";;;;;;;AAAA;;AAEA;;;;;;;;AAUA,MAAMA,qBAAqB,gBAAGC,cAAA,CAAMC,aAAN,CAA+C;EAC3EC,mBAAmB,EAAE,MAAM,CACzB;EACD,CAH0E;EAI3EC,WAAW,EAAE;AAJ8D,CAA/C,CAA9B;;;;AAeA,MAAMC,6BAAuC,gBAAGJ,cAAA,CAAMK,IAAN,CAAW,QAAkB;EAAA,IAAjB;IAAEC;EAAF,CAAiB;EAC3E,MAAM,CAACC,MAAD,EAASC,SAAT,IAAsB,IAAAC,eAAA,EAAqC;IAC/DC,cAAc,EAAE;EAD+C,CAArC,CAA5B;EAIA,MAAMR,mBAAqE,GACzE,IAAAS,kBAAA,EAAY,SAAwB;IAAA,IAAvB;MAAEC,IAAF;MAAQC;IAAR,CAAuB;IAClCL,SAAS,CAAC;MAAEE,cAAc,EAAE,IAAlB;MAAwBE,IAAxB;MAA8BC;IAA9B,CAAD,CAAT;EACD,CAFD,EAEG,EAFH,CADF;EAKA,MAAMA,QAAQ,GAAG,IAAAF,kBAAA,EACdG,KAAD,IAAsB;IAAA;;IACpB,oBAAAP,MAAM,CAACM,QAAP,2EAAAN,MAAM,EAAYO,KAAZ,CAAN;IACAN,SAAS,CAAC;MAAEE,cAAc,EAAE;IAAlB,CAAD,CAAT;EACD,CAJc,EAKf,CAACH,MAAD,CALe,CAAjB;EAQA,MAAMQ,KAAK,GAAG,IAAAC,cAAA,EACZ,OAAO;IACLd,mBADK;IAELC,WAAW,EAAEI,MAAM,CAACG;EAFf,CAAP,CADY,EAKZ,CAACH,MAAM,CAACG,cAAR,EAAwBR,mBAAxB,CALY,CAAd;EAQA,oBACE,6BAAC,qBAAD,CAAuB,QAAvB;IAAgC,KAAK,EAAEa;EAAvC,GACGR,MAAM,CAACG,cAAP,iBACC,6BAAC,uBAAD;IAAiB,IAAI,EAAC;EAAtB,GAA8BH,MAA9B;IAAsC,QAAQ,EAAEM;EAAhD,GAFJ,EAIGP,QAJH,CADF;AAQD,CAlC+C,CAAhD"}